'use strict';(function(a,b){a.Redux&&a.Glace?a.Tart=b():a.define&&a.define.amd&&a.define(b)})(void 0,function(){function a(a,b){var c,d,e,g='TemplateError';a.textContent.replace(/ line (\d+?)| column (\d+?)|: (.*?)$/gm,function(a,b,f,g){c=c||b,d=d||f,e=e||g}),f(this,{message:e,name:g,file:b,line:c,column:d,stack:g+' '+e+'\n\tat '+(this.file||'<anonymous>')+':'+c+':'+d})}var b=function(){},c=function(){return{output:[],update:b}},d=new DOMParser,e=Object.keys,f=Object.assign,g='parsererror',h='_yieldedTemplate_',i=Array.isArray,j=[].forEach,k=document.createElement('div'),l={},m=function(a){return l[a]},n=function(a,b){b.parentNode.insertBefore(a,b)},o=function(a){a.parentNode.removeChild(a)},p=function(a){return k.textContent=a,k.innerHTML},q=function(a){var b=a.ownerDocument.createDocumentFragment();return b.appendChild(a),a},r=function(a){return q(a.createTextNode(''))},s=function(a,b,d){a=a||c,b=b||c;var e=w(d);return function(d,f,g){var h,i=c(),j=r(d),k=function(f){if(!j.parentNode)return i=c(),void(h=void 0);var k=!!e(f);k===h?i.update(f):(h=k,i.output.forEach(function(a){return o(a)}),i=k?a(d,f,g):b(d,f,g),i.output.forEach(function(a){return n(a,j)}))};return k(f),{output:[].slice.call(j.parentNode.childNodes),update:k}}},t=function(a,b,d){var e=w(b),g=d?w(d):function(a){return a},i=function(b){var c=f({},b);return c[h]=a,c};return function(a,b,d){var f,h=r(a),j={output:[],update:function(){}},k=function(b){b=i(g(b));var k=e(b)||c;k===f?j.update(b):(f=k,'string'==typeof f&&(f=m(f)),j.output.forEach(function(a){return o(a)}),j=f(a,b,d),j.output.forEach(function(a){return n(a,h)}))};return k(b),{output:[].slice.call(j.output).concat([h]),update:k}}},u=function(a,b,c,d){var e=w(b),f=[],g=[];c=c||'content',d=d||'index';var h=function(a,b,e){var f={parent:a};return f[c]=e,f[d]=b,f};return function(b,c,d){var j=r(b),i=function(c){if(!j.parentNode)return f=[],void(g=[]);var k=e(c)||[];for(var l=Math.max(f.length,k.length),m=j.parentNode,p=function(e){var i=g[e+1]&&g[e+1].output[0]||j;f[e]&&k[e]?f[e]!==k[e]&&g[e].update(h(c,e,k[e])):f[e]&&!k[e]?(g[e].output.forEach(function(a){return o(a)}),g[e]=null):!f[e]&&k[e]&&(g[e]=a(b,h(c,e,k[e]),d),g[e].output.forEach(function(a){return n(a,i)}))},q=0;q<l;q+=1)p(q);g.length=k.length,f=k};return i(c),{output:[].slice.call(j.parentNode.childNodes),update:i}}},v=function(a){var b,c=[],d=[],e=0;b=0;for(var f=0;f<a.length;f+=1){if('\\'===a[f]&&'$'===a[f+1]||'\\'===a[f+1]){d.push(a[f+1]),f+=1;continue}if(0===b&&'$'===a[f]&&'{'===a[f+1]){b=1,f+=1,e=1,c.push(d.join('')),d=[];continue}if(1===b){if('{'===a[f]){e+=1,d.push(a[f]);continue}if('}'===a[f]&&(e-=1,0==e)){b=0,c.push(d.join('')),d=[];continue}}d.push(a[f])}if(1===b)throw new Error('Unclosed template literal: '+a);return d.length&&c.push(d.join('')),c},w=function(a){var b='return function(state){try{with(state){return($)}}catch(e){return undefined}}'.replace(/\$/g,a),c=new Function('sanitize',b)(p);return c.expression=a,c},x=function(a){return a=a.map(function(a){return'string'==typeof a?F(a):i(a)?x(a):a}),function(b,c,d){var e=[],f=[];return a.forEach(function(a){var g=a(b,c,d);e=e.concat(g.output),f.push(g.update)}),{output:e,update:function update(a){f.forEach(function(b){return b(a)})}}}},y=function(a){var c=[];return a.forEach(function(a){if(a.nodeType===Node.TEXT_NODE)return v(a.textContent).forEach(function(a,d){if(a)if(0==d%2)c.push(function(c){return{output:[c.createTextNode(a)],update:b}});else{var e=w(a);c.push(function(a,b){var c=a.createTextNode(e(b));return{output:[c],update:function update(a){c.textContent=e(a)}}})}});if(a.nodeType===Node.ELEMENT_NODE){var e=a.tagName,d=e.toLowerCase();if(m.tagHandlers[d])return void c.push(A(d,a));var f=y([].slice.call(a.childNodes)),g=[],h=[];j.call(a.attributes,function(a){'on-'===a.nodeName.substr(0,3)?h.push({name:a.nodeName.substr(3),action:new Function('event','state','dispatch','with(state){\n'+a.nodeValue+'\n}')}):g.push({name:a.nodeName,value:v(a.nodeValue).map(function(a,b){return 0==b%2?a:w(a)})})}),c.push(function(a,b,c){var d=a.createElement(e);h.forEach(function(a){d.addEventListener(a.name,function(b){return a.action.call(b.target,b,j,c)},!1)});var i=[];f.forEach(function(e){var f=e(a,b,c);i.push(f.update),f.output.forEach(function(a){d.appendChild(a)})});var j=b,k=function(a){j=a,g.forEach(function(b){C[b.name]?C[b.name](a,d,b.value):d.setAttribute(b.name,b.value.map(function(b){return b instanceof Function?b(a):b}).join(''))}),i.forEach(function(b){return b(a)})};return k(b),{output:[d],update:k}})}}),c},z=function(a){return x(y([].slice.call(a)))},A=function(a,b){var c={};return j.call(b.attributes,function(a){c[a.nodeName]=a.nodeValue}),c.TEMPLATE=z(b.childNodes),m.tagHandlers[a](c)},B=function(a,b){return a.map(function(a,c){if(0==c%2)return a;var d=a(b);return!0===d?a.expression.replace(/^[^\.]*\./,''):d?d:''}).join('').trim()},C={class:function _class(a,b,c){b.className=B(c,a)}},D=function(a,b,c){var d=c;'string'==typeof d&&(d=F(c)),i(d)&&(d=x(d)),m.tagHandlers[a]=function(a){var c=b.reduce(function(b,c){return b[c]=w(a[c]),b},{}),g=function(a){var b=f({},a);return e(c).forEach(function(d){b[d]=c[d](a)}),b};return function(a,b,c){var e=d(a,g(b),c);return e.update=E(e.update,g),e}}},E=function(a,b){return function(c){a(b(c))}},F=function(b,c){var e=d.parseFromString('<G>'+b+'</G>','text/xml'),f=e.querySelector(g);if(f)throw new a(e.querySelector(g+'>div'),c);var h=y([].slice.call(e.childNodes[0].childNodes));return x(h)},G=function(a,b){var c,e=null,g=function(){return e=fetch(a).then(function(a){return a.text()}).then(function(b){return F(b,a)}),e};return template=function template(a,d,h){if(c)return c(a,d,h);e||g();var i=q(f(a.createElement('div'),{className:b||'glace-loading'})),j=[i],k=d,l=function update(a){k=a};return e.then(function(b){var c=b(a,k,h);l=c.update,c.output.forEach(function(a){n(a,i),j.push(a)}),j.shift(),o(i)}),{output:j,update:function update(a){return l(a)}}},template.fetch=g,template};f(m,{compile:F,fetch:G,append:function append(a,b,c,d){'string'==typeof b&&(b=m(b));var e=a.ownerDocument,f=null;c&&c.getState&&c.subscribe&&(f=c,d=f.dispatch,c=f.getState());var g=b(e,c,d);if(g.output.forEach(function(b){a.appendChild(b)}),f){var h=!1;f.subscribe(function(){h||(h=!0,requestAnimationFrame(function(){g.update(f.getState()),h=!1}))})}return g.update},tagHandlers:{if:function _if(a){return s(a.TEMPLATE,null,a.cond)},unless:function unless(a){return s(null,a.TEMPLATE,a.cond)},for:function _for(a){return u(a.template||a.TEMPLATE,a.each,a.as,a.index)},view:function view(a){return t(a.TEMPLATE,a.template,a.state)},yield:function _yield(){return function(a,b,c){var d=f({},b);return delete d[h],b[h](a,d,c)}}},tagHandler:D,getter:w,Error:a});var H=function(a,b,c){template=l[a]?l[a]:c(),b&&(b=b.split(',').map(function(a){return a.trim()}),D(a,b,template)),l[a]=template};return j.call(document.querySelectorAll('script[id][type="'+'text/glace-template'+'"]'),function(){H(scr.id,scr.getAttribute('props'),function(){return F(scr.textContent,'#'+scr.id)})}),j.call(document.querySelectorAll('meta[glace-template]'),function(a){var b=a.getAttribute('glace-template'),c=b.replace(/^.*\/|\.tpl$/g,'');H(c,a.getAttribute('props'),function(){return G(b,a.getAttribute('loading-class'))})}),m});
